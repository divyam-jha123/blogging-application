<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blogify</title>

  <%- include('./partials/head') %>
</head>

<body>
  <%- include('./partials/nav') %>

    <div class="container mt-4">
      <div class="row">
        <% if (blogs && blogs.length> 0) { %>
          <% blogs.forEach(blog=> { %>
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <% if (blog.coverImageUrl) { %>
                  <img src="<%= blog.coverImageUrl %>" class="card-img-top" alt="<%= blog.title %>"
                    style="height: 180px; object-fit: cover;">
                  <% } else { %>
                    <div class="card-img-top bg-secondary d-flex align-items-center justify-content-center"
                      style="height: 180px;">
                      <span class="text-white">No Image</span>
                    </div>
                    <% } %>
                      <div class="card-body">
                        <h5 class="card-title">
                          <%= blog.title %>
                        </h5>
                        <p class="card-text text-muted">
                          <%= blog.body ? blog.body.substring(0, 100) + '...' : '' %>
                        </p>
                      </div>
                      <div class="card-footer d-flex justify-content-end align-items-center">
                        <a href="/blog/<%= blog._id %>" class="btn btn-primary btn-sm">Read More</a>
                      </div>
              </div>
            </div>
            <% }) %>
              <% } else { %>
                <div class="col-12 text-center py-5">
                  <h4>No blogs yet</h4>
                  <p class="text-muted">Be the first to create a blog!</p>
                  <a href="/blog/add-new" class="btn btn-primary">Create Blog</a>
                </div>
                <% } %>
      </div>
    </div>

    <%- include('./partials/script') %>
      <script>
        function showConfirm(blogId) {
          document.getElementById(`delete-container-${blogId}`).classList.add('d-none');
          document.getElementById(`delete-container-${blogId}`).classList.remove('d-inline');
          document.getElementById(`confirm-container-${blogId}`).classList.remove('d-none');
          document.getElementById(`confirm-container-${blogId}`).classList.add('d-inline');
        }

        function hideConfirm(blogId) {
          document.getElementById(`confirm-container-${blogId}`).classList.add('d-none');
          document.getElementById(`confirm-container-${blogId}`).classList.remove('d-inline');
          document.getElementById(`delete-container-${blogId}`).classList.remove('d-none');
          document.getElementById(`delete-container-${blogId}`).classList.add('d-inline');
        }
      </script>

      <!-- Add Blog Fixed Button -->
      <style>
        #addBlogBtn {
          position: fixed;
          top: 50%;
          right: 0;
          transform: translateY(-50%);
          background-color: black;
          color: white;
          padding: 10px 15px;
          text-decoration: none;
          font-weight: bold;
          border-top-left-radius: 8px;
          border-bottom-left-radius: 8px;
          box-shadow: -2px 2px 10px rgba(0, 0, 0, 0.2);
          z-index: 1000;
          transition: transform 0.3s ease-in-out, background-color 0.2s;
        }

        #addBlogBtn:hover {
          background-color: #333;
        }

        /* Mobile Viewport Adjustment */
        @media (max-width: 768px) {
          #addBlogBtn {
            padding: 8px 12px;
            font-size: 14px;
            border-top-left-radius: 5px;
            border-bottom-left-radius: 5px;
          }
        }
      </style>

      <a href="/blog/add-new" id="addBlogBtn">
        Add Blog
      </a>

      <script>
        let isScrolling;
        const addBlogBtn = document.getElementById('addBlogBtn');

        window.addEventListener('scroll', () => {
          // Hide button while scrolling
          addBlogBtn.style.transform = 'translate(100%, -50%)';

          // Clear previous timeout
          window.clearTimeout(isScrolling);

          // Set a timeout to run after scrolling ends
          isScrolling = setTimeout(() => {
            // Show button again
            addBlogBtn.style.transform = 'translate(0, -50%)';
          }, 150);
        });
      </script>
</body>

</html>